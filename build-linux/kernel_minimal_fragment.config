# Minimal kernel fragment for RISC-V emulator
# Apply on top of allnoconfig

# RISC-V 32-bit architecture
CONFIG_32BIT=y
# CONFIG_64BIT is not set
CONFIG_ARCH_RV32I=y
# CONFIG_ARCH_RV64I is not set
CONFIG_RISCV_ISA_M=y
CONFIG_RISCV_ISA_A=y
# CONFIG_RISCV_ISA_C is not set
CONFIG_SBI=y
CONFIG_SBI_V01=y
CONFIG_NONPORTABLE=y

# Disable EFI explicitly (has default y)
# CONFIG_EFI is not set

# Basic system
CONFIG_PRINTK=y
CONFIG_BUG=y
CONFIG_CC_OPTIMIZE_FOR_SIZE=y
CONFIG_EMBEDDED=y
CONFIG_SYSVIPC=y

# Initramfs support
CONFIG_BLK_DEV_INITRD=y

# Executable formats
CONFIG_BINFMT_ELF=y

# Basic syscalls
CONFIG_FUTEX=y
CONFIG_EPOLL=y
CONFIG_SIGNALFD=y
CONFIG_TIMERFD=y
CONFIG_EVENTFD=y

# Memory
CONFIG_MMU=y
CONFIG_SHMEM=y
CONFIG_TMPFS=y

# Block layer (minimal)
CONFIG_BLOCK=y

# Device drivers
CONFIG_DEVTMPFS=y
CONFIG_DEVTMPFS_MOUNT=y

# Disable VT/Input (we only use virtio console)
# CONFIG_VT is not set
# CONFIG_INPUT is not set
# CONFIG_HID is not set
# CONFIG_HID_SUPPORT is not set

# TTY/Serial console
CONFIG_TTY=y
CONFIG_UNIX98_PTYS=y
CONFIG_SERIAL_EARLYCON_RISCV_SBI=y
CONFIG_SERIAL_CORE=y
CONFIG_SERIAL_CORE_CONSOLE=y
CONFIG_HVC_DRIVER=y
CONFIG_HVC_RISCV_SBI=y

# NS16550/8250 UART for QEMU virt machine
CONFIG_SERIAL_8250=y
CONFIG_SERIAL_8250_CONSOLE=y
CONFIG_SERIAL_OF_PLATFORM=y
CONFIG_SERIAL_EARLYCON=y

# VirtIO (for console and disk)
CONFIG_VIRTIO_MENU=y
CONFIG_VIRTIO=y
CONFIG_VIRTIO_MMIO=y
CONFIG_VIRTIO_MMIO_CMDLINE_DEVICES=y
CONFIG_VIRTIO_BLK=y
CONFIG_VIRTIO_CONSOLE=y

# Pseudo filesystems
CONFIG_PROC_FS=y
CONFIG_PROC_SYSCTL=y
CONFIG_SYSFS=y
CONFIG_KERNFS=y

# Device tree (required)
CONFIG_OF=y
CONFIG_OF_FLATTREE=y
