# Ultra-Minimal Linux Kernel Config for RISC-V 32-bit Emulator
# Target: Boot with initramfs, virtio console, < 5MB uncompressed
# Disable: EFI, ext4, btrfs, crypto, networking, SMP, FPU, debugging

#
# General setup
#
CONFIG_LOCALVERSION="-tiny"
# CONFIG_LOCALVERSION_AUTO is not set
CONFIG_DEFAULT_HOSTNAME="riscv"
CONFIG_SYSVIPC=y
# CONFIG_POSIX_MQUEUE is not set
# CONFIG_WATCH_QUEUE is not set
# CONFIG_CROSS_MEMORY_ATTACH is not set
# CONFIG_USELIB is not set
# CONFIG_AUDIT is not set
# CONFIG_CGROUPS is not set
# CONFIG_CHECKPOINT_RESTORE is not set
# CONFIG_SCHED_AUTOGROUP is not set
# CONFIG_RELAY is not set

# Initramfs support (required for cpio boot)
CONFIG_BLK_DEV_INITRD=y
CONFIG_INITRAMFS_SOURCE=""
# CONFIG_INITRAMFS_FORCE is not set

CONFIG_CC_OPTIMIZE_FOR_SIZE=y
# CONFIG_KALLSYMS is not set
CONFIG_PRINTK=y
CONFIG_BUG=y
# CONFIG_ELF_CORE is not set
# CONFIG_PCSPKR_PLATFORM is not set
CONFIG_FUTEX=y
CONFIG_EPOLL=y
CONFIG_SIGNALFD=y
CONFIG_TIMERFD=y
CONFIG_EVENTFD=y
CONFIG_SHMEM=y
# CONFIG_AIO is not set
# CONFIG_IO_URING is not set
# CONFIG_ADVISE_SYSCALLS is not set
# CONFIG_MEMBARRIER is not set
# CONFIG_KCMP is not set
# CONFIG_RSEQ is not set
CONFIG_EMBEDDED=y
# CONFIG_PC104 is not set
# CONFIG_PROFILING is not set
# CONFIG_SECCOMP is not set
# CONFIG_COMPAT is not set

# Disable modules
# CONFIG_MODULES is not set

#
# RISC-V Architecture
#
CONFIG_ARCH_RV32I=y
CONFIG_CMODEL_MEDLOW=y
CONFIG_RISCV_ISA_M=y
CONFIG_RISCV_ISA_A=y
# CONFIG_RISCV_ISA_C is not set
# CONFIG_FPU is not set
# CONFIG_RISCV_ISA_ZICBOM is not set
# CONFIG_RISCV_ISA_ZICBOZ is not set
CONFIG_SBI=y
CONFIG_SBI_V01=y

# EFI - MUST DISABLE for raw Image boot
# Set NONPORTABLE to prevent PORTABLE from selecting EFI
CONFIG_NONPORTABLE=y
# CONFIG_PORTABLE is not set
# CONFIG_EFI is not set
# CONFIG_EFI_STUB is not set

# Single CPU - no SMP
# CONFIG_SMP is not set
CONFIG_NR_CPUS=1
# CONFIG_HOTPLUG_CPU is not set
# CONFIG_NUMA is not set

#
# Power management - disabled
#
# CONFIG_SUSPEND is not set
# CONFIG_PM is not set
# CONFIG_CPU_FREQ is not set

#
# Memory Management - minimal
#
CONFIG_FLATMEM=y
CONFIG_FLAT_NODE_MEM_MAP=y
# CONFIG_SPARSEMEM_MANUAL is not set
# CONFIG_MEMORY_HOTPLUG is not set
# CONFIG_COMPACTION is not set
# CONFIG_KSM is not set
CONFIG_DEFAULT_MMAP_MIN_ADDR=4096
# CONFIG_TRANSPARENT_HUGEPAGE is not set
# CONFIG_CMA is not set
# CONFIG_ZPOOL is not set
# CONFIG_ZBUD is not set
# CONFIG_ZSMALLOC is not set

#
# Executable file formats
#
CONFIG_BINFMT_ELF=y
# CONFIG_COMPAT_BINFMT_ELF is not set
# CONFIG_BINFMT_SCRIPT is not set
# CONFIG_BINFMT_MISC is not set
# CONFIG_COREDUMP is not set

#
# Networking - DISABLED
#
# CONFIG_NET is not set

#
# Device Drivers - minimal
#
CONFIG_UEVENT_HELPER=y
CONFIG_UEVENT_HELPER_PATH=""
CONFIG_DEVTMPFS=y
CONFIG_DEVTMPFS_MOUNT=y
# CONFIG_STANDALONE is not set
# CONFIG_PREVENT_FIRMWARE_BUILD is not set
# CONFIG_FW_LOADER is not set
# CONFIG_ALLOW_DEV_COREDUMP is not set
# CONFIG_REGMAP is not set
# CONFIG_DMA_CMA is not set

#
# Bus devices - disabled
#
# CONFIG_CONNECTOR is not set
# CONFIG_GNSS is not set
# CONFIG_MTD is not set
# CONFIG_PARPORT is not set
# CONFIG_PNP is not set

#
# Block devices - minimal
#
CONFIG_BLOCK=y
# CONFIG_BLK_DEV_BSG is not set
# CONFIG_BLK_DEV_BSGLIB is not set
# CONFIG_BLK_DEV_INTEGRITY is not set
# CONFIG_BLK_DEV_ZONED is not set
# CONFIG_BLK_DEV_THROTTLING is not set
# CONFIG_BLK_WBT is not set
# CONFIG_BLK_DEV_FD is not set
# CONFIG_BLK_DEV_LOOP is not set
# CONFIG_BLK_DEV_NBD is not set
# CONFIG_BLK_DEV_RAM is not set

#
# NVME - disabled
#
# CONFIG_NVME_CORE is not set

#
# Misc devices - disabled
#
# CONFIG_DUMMY_IRQ is not set
# CONFIG_SRAM is not set

#
# SCSI - disabled
#
# CONFIG_SCSI is not set

#
# RAID/LVM - disabled
#
# CONFIG_MD is not set

#
# VirtIO Support - required for console
#
CONFIG_VIRTIO_MENU=y
CONFIG_VIRTIO=y
CONFIG_VIRTIO_MMIO=y
CONFIG_VIRTIO_MMIO_CMDLINE_DEVICES=y
# CONFIG_VIRTIO_PCI is not set
CONFIG_VIRTIO_BLK=y
CONFIG_VIRTIO_CONSOLE=y

#
# Character devices - minimal
#
CONFIG_TTY=y
# CONFIG_VT is not set
CONFIG_UNIX98_PTYS=y
# CONFIG_LEGACY_PTYS is not set
# CONFIG_SERIAL_NONSTANDARD is not set

#
# Serial drivers - SBI only
#
# CONFIG_SERIAL_8250 is not set
CONFIG_SERIAL_EARLYCON_RISCV_SBI=y
CONFIG_SERIAL_CORE=y
CONFIG_SERIAL_CORE_CONSOLE=y
CONFIG_HVC_DRIVER=y
CONFIG_HVC_RISCV_SBI=y

# Random disabled
# CONFIG_HW_RANDOM is not set

#
# I2C/SPI/1-wire - disabled
#
# CONFIG_I2C is not set
# CONFIG_SPI is not set
# CONFIG_W1 is not set
# CONFIG_HWMON is not set
# CONFIG_THERMAL is not set
# CONFIG_WATCHDOG is not set
# CONFIG_REGULATOR is not set
# CONFIG_MEDIA_SUPPORT is not set
# CONFIG_DRM is not set
# CONFIG_FB is not set
# CONFIG_SOUND is not set
# CONFIG_HID is not set
# CONFIG_HID_SUPPORT is not set
# CONFIG_USB_SUPPORT is not set
# CONFIG_USB is not set
# CONFIG_INPUT is not set
# CONFIG_INPUT_KEYBOARD is not set
# CONFIG_INPUT_MOUSE is not set
# CONFIG_SERIO is not set
# CONFIG_KEYBOARD_ATKBD is not set
# CONFIG_MOUSE_PS2 is not set
# CONFIG_MMC is not set
# CONFIG_RTC_CLASS is not set
# CONFIG_DMADEVICES is not set
# CONFIG_VFIO is not set

#
# File systems - MINIMAL (initramfs only, no ext4/btrfs)
#
# CONFIG_EXT2_FS is not set
# CONFIG_EXT3_FS is not set
# CONFIG_EXT4_FS is not set
# CONFIG_REISERFS_FS is not set
# CONFIG_JFS_FS is not set
# CONFIG_XFS_FS is not set
# CONFIG_GFS2_FS is not set
# CONFIG_BTRFS_FS is not set
# CONFIG_NILFS2_FS is not set
# CONFIG_F2FS_FS is not set
# CONFIG_FS_DAX is not set
# CONFIG_FS_POSIX_ACL is not set
# CONFIG_FILE_LOCKING is not set
# CONFIG_FS_ENCRYPTION is not set
# CONFIG_FS_VERITY is not set
# CONFIG_DNOTIFY is not set
# CONFIG_INOTIFY_USER is not set
# CONFIG_FANOTIFY is not set
# CONFIG_QUOTA is not set
# CONFIG_AUTOFS_FS is not set
# CONFIG_FUSE_FS is not set
# CONFIG_OVERLAY_FS is not set
# CONFIG_FSCACHE is not set

# CD-ROM disabled
# CONFIG_ISO9660_FS is not set
# CONFIG_UDF_FS is not set

# DOS/FAT/NTFS disabled
# CONFIG_MSDOS_FS is not set
# CONFIG_VFAT_FS is not set
# CONFIG_EXFAT_FS is not set
# CONFIG_NTFS_FS is not set
# CONFIG_NTFS3_FS is not set

#
# Pseudo filesystems - required
#
CONFIG_PROC_FS=y
# CONFIG_PROC_KCORE is not set
CONFIG_PROC_SYSCTL=y
CONFIG_KERNFS=y
CONFIG_SYSFS=y
CONFIG_TMPFS=y
# CONFIG_TMPFS_POSIX_ACL is not set
# CONFIG_TMPFS_XATTR is not set
# CONFIG_HUGETLBFS is not set
# CONFIG_CONFIGFS_FS is not set
# CONFIG_EFIVAR_FS is not set

# Misc filesystems - disabled
# CONFIG_CRAMFS is not set
# CONFIG_SQUASHFS is not set
# CONFIG_ROMFS_FS is not set
# CONFIG_PSTORE is not set

# Network filesystems - disabled
# CONFIG_NFS_FS is not set
# CONFIG_NFSD is not set

#
# Kernel hacking - DISABLED for size
#
# CONFIG_DEBUG_FS is not set
# CONFIG_DEBUG_KERNEL is not set
# CONFIG_SLUB_DEBUG is not set
# CONFIG_DEBUG_MISC is not set
# CONFIG_SCHED_DEBUG is not set
# CONFIG_DEBUG_PREEMPT is not set
# CONFIG_DEBUG_INFO is not set
# CONFIG_DEBUG_VM is not set
# CONFIG_DEBUG_MEMORY_INIT is not set
# CONFIG_DEBUG_SPINLOCK is not set
# CONFIG_DEBUG_MUTEXES is not set
# CONFIG_DEBUG_RWSEMS is not set
# CONFIG_DEBUG_ATOMIC_SLEEP is not set
# CONFIG_DEBUG_LOCKING_API_SELFTESTS is not set
# CONFIG_DEBUG_LIST is not set
# CONFIG_DEBUG_PLIST is not set
# CONFIG_DEBUG_SG is not set
# CONFIG_DEBUG_NOTIFIERS is not set
# CONFIG_DEBUG_CREDENTIALS is not set
# CONFIG_FTRACE is not set
# CONFIG_KGDB is not set
# CONFIG_UBSAN is not set
CONFIG_PANIC_TIMEOUT=0
# CONFIG_PANIC_ON_OOPS is not set

#
# Security - DISABLED
#
# CONFIG_KEYS is not set
# CONFIG_SECURITY is not set
# CONFIG_SECURITYFS is not set
# CONFIG_SECURITY_NETWORK is not set
# CONFIG_SECURITY_PATH is not set
# CONFIG_SECURITY_SELINUX is not set
# CONFIG_SECURITY_SMACK is not set
# CONFIG_SECURITY_TOMOYO is not set
# CONFIG_SECURITY_APPARMOR is not set
# CONFIG_INTEGRITY is not set
# CONFIG_IMA is not set
# CONFIG_EVM is not set

#
# Crypto - DISABLED
#
# CONFIG_CRYPTO is not set

#
# Library routines - minimal
#
# CONFIG_CRC_CCITT is not set
# CONFIG_CRC16 is not set
# CONFIG_CRC32 is not set
# CONFIG_CRC64 is not set
# CONFIG_LIBCRC32C is not set
# CONFIG_XZ_DEC is not set

#
# EFI - DISABLED (use raw Image format)
#
# CONFIG_EFI is not set
# CONFIG_EFI_STUB is not set

#
# BPF - disabled
#
# CONFIG_BPF_SYSCALL is not set

#
# Additional forced disables (override defaults)
#
# CONFIG_EFI is not set
# CONFIG_EFI_STUB is not set  
# CONFIG_EFI_GENERIC_STUB is not set
# CONFIG_EFI_PARAMS_FROM_FDT is not set
# CONFIG_COMPAT is not set
# CONFIG_COMPAT_32BIT_TIME is not set
# CONFIG_COMPAT_BINFMT_ELF is not set
# CONFIG_INPUT is not set
# CONFIG_INPUT_KEYBOARD is not set
# CONFIG_INPUT_MOUSE is not set
# CONFIG_SERIO is not set
# CONFIG_HID_SUPPORT is not set
# CONFIG_AIO is not set
# CONFIG_IO_URING is not set
# CONFIG_SECCOMP is not set
# CONFIG_RSEQ is not set
# CONFIG_KALLSYMS is not set
# CONFIG_HIGH_RES_TIMERS is not set
# CONFIG_NO_HZ_IDLE is not set
# CONFIG_PREEMPT_NONE is not set
CONFIG_PREEMPT_NONE=y

# VT/VGA console - must disable when EFI is off
# CONFIG_VT is not set
# CONFIG_VT_CONSOLE is not set
# CONFIG_VGA_CONSOLE is not set
# CONFIG_DUMMY_CONSOLE is not set
# CONFIG_FRAMEBUFFER_CONSOLE is not set

# Device Tree is required for RISC-V
CONFIG_OF=y
CONFIG_OF_FLATTREE=y
